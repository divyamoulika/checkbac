YUI.add("surfer",function(e){var c,b,d=(e.UA.webkit?true:false);time=0,playTimer={timer:false,delay:5000,startDelay:300};EVT_NEXTCLICK="nextClick",EVT_PREVCLICK="prevClick",EVT_ITEMCHANGE="itemChange",EVT_ITEMCHANGED="itemChanged",EVT_READY="ready",EVT_CLOSE="close",EVT_END="end",EVT_PLAY="play",EVT_PAUSE="pause",EVT_RESIZE="resize";function a(f){a.superclass.constructor.apply(this,arguments)}a.ATTRS={nxtNode:{writeOnce:true,setter:e.one,validator:e.Lang.isString},prvNode:{writeOnce:true,setter:e.one,validator:e.Lang.isString},easing:{value:"ease-out"},transitionDuration:{value:300,validator:e.Lang.isNumber},transitionLimit:{value:400,validator:e.Lang.isNumber},datamodel:{value:null},curPos:{value:1,validator:e.Lang.isNumber},disableHistory:{value:true},history:{value:false},fromOverlay:{value:false},fullScreenMode:{value:false},cssResultClass:{value:"card"},titleField:{value:"tit"},urlField:{value:"url"},autoPlayDelay:{value:5000},microTemplate:{writeOnce:true,setter:e.one,validator:e.Lang.isString}};a.NAME="surfer";e.extend(a,e.Widget,{initializer:function(f){var g=this;g.last=false;g.first=false;g._high=0;g._low=0;g.prefetched=[];g._events=[];g._touchSupport="ontouchstart" in e.config.win;g._disableTransition=!g._touchSupport;g._moving=false;g._easing=this.get("easing");g._duration=this.get("transitionDuration");g._nxtNode=this.get("nxtNode");g._prvNode=this.get("prvNode");g._cb=this.get("contentBox");g._bb=this.get("boundingBox");playTimer.delay=this.get("autoPlayDelay");g.cssclass=this.get("cssResultClass");g.current=g.get("curPos");g.previous=g.current;time=this._getTime();g.history=g.get("history");if(!g.history&&!g.get("disableHistory")){if(e.config.win.history&&e.config.win.history.pushState){e.use("history-html5",function(h){g.history=new h.HistoryHTML5({initialState:{index:g.current}})})}}if(this.get("microTemplate")){this.compiled=e.Template.Micro.compile(this.get("microTemplate").getHTML())}else{this.compiled=null}},destructor:function(){this._detachEvents()},renderUI:function(){this._scrollToTop();this._setDims()},bindUI:function(){var f=this;f._bindIO();if(f._touchSupport){f._events.push(e.on("touchmove",function(g){g.halt()},window));f._cb.on("touchstart",f._onTouchStart,f);f._cb.on("touchmove",f._onTouchMove,f);f._cb.on("flick",e.bind(f._onFlick,f))}f._events.push(e.on("orientationchange",f._onResize,e.config.win,f,"orient"));f._events.push(e.on("windowresize",f._onResize,e.config.win,f,"resize"));f._events.push(f.on("fullScreenModeChange",f._onResize,f));f.on("forward",f.forward,f);f.on("backward",f.backward,f);f.on("repaint",f.repaint,f);f._nxtNode.on("click",f._next,f);f._prvNode.on("click",f._prev,f);f._events.push(e.on("key",f._prev,e.config.doc.body,"down:37",f));f._events.push(e.on("key",f._next,e.config.doc.body,"down:39",f));if(!f.get("disableHistory")){f._events.push(e.on("history:change",f._handleHistChange,f))}f._bindCustom()},syncUI:function(){var j=this;j._resizeContents();var f=e.Node.create('<li class="'+j.cssclass+'"></li>'),g=e.Node.create('<li class="'+j.cssclass+'"></li>');if(j._cb.one("li")){var h=j._cb.one("li")}else{var h=e.Node.create('<li class="'+j.cssclass+'"></li>');j._cb.append(h)}h.addClass("current");j._cb.append(f);j._cb.append(g);j._updateUI(this.get("fromOverlay"),this.get("fromOverlay"));j.fire(EVT_READY)},_bindIO:function(){this.io=this.get("datamodel");this._syncBoundaries();this._events.push(this.io.on("data",e.bind(this._onData,this)))},_updateUI:function(p,r){var t=this;var o=t._data(t.current),m=t._data(t.current,1),l=t._data(t.current,-1),j=t.io.offset(t.current,-1),n=t.io.offset(t.current,1);var g=t._cb.one(".current");var k=g.get("nextSibling");if(!k){k=t._cb.all("li."+t.cssclass).item(0)}var f=g.get("previousSibling");if(!f){f=t._cb.all("li."+t.cssclass).item(2)}t.fire(EVT_ITEMCHANGE,{data:o,logPV:r,index:t.current,fromSrp:p,prevIndex:t.previous,node:g,forward:false});t._setItem(o,g,t.current);t._setItemID(t.current,g);if(r){t._updateBrowser(t.current,o)}t.prefetched[t.current]=1;if(m){t._setItem(m,k,n);t._setItemID(n,k);t.prefetched[n]=1;t.last=false}else{t.last=true}t._transOrLeft(k,t.twidth);if(l){t._setItem(l,f,j);t._setItemID(j,f);t.prefetched[j]=1;t.first=false}else{t.first=true;var h=t._data(t.current,2),q=t.io.offset(t.current,2);if(h){t._setItem(h,f,q);t._setItemID(q,f);t.prefetched[q]=1}}t._transOrLeft(f,-1*t.twidth);t._toggleNextPrev();t.fire(EVT_ITEMCHANGED,{data:o,node:g,index:t.current})},_handleHistChange:function(f){if(f.changed.index&&f.changed.index.newVal==-9999){this.fire(EVT_CLOSE);return}if(f.changed.index&&f.changed.index.newVal!=this.current){this._moveTo(f.changed.index.newVal)}},_onData:function(f){this._syncBoundaries();if(!this._moving){if(this.current<this._high){this.last=false;this.fire("repaint",{backward:false,forward:false,resize:false,sync:true})}}this.fire("data",f)},_data:function(g,f){return this.io.item(g,f)},getData:function(f){if(!e.Lang.isValue(f)){f=this.current}return this.io.item(f,0)},_syncBoundaries:function(){var f=this.io._posMap;if(f){this._low=f[0];this._high=f[f.length-1]}else{this._low=0;this._high=this.io._items.length-1}},_transform:function(f){return(d)?"translate3d("+f+", 0, 0)":"translate("+f+",0)"},_transOrLeft:function(g,f){if(!e.UA.ie&&(!e.UA.gecko||e.UA.android)){g.setStyle("transform",this._transform(f+"px"))}else{g.setStyle("left",f+"px")}},_next:function(f){if(f.target.get("nodeName")=="INPUT"){return}f.preventDefault();if(this.get("isPlaying")){this.pause()}this.fire(EVT_NEXTCLICK);this.next()},next:function(){this.fire("forward")},_prev:function(f){if(f.target.get("nodeName")=="INPUT"){return}f.preventDefault();if(this.get("isPlaying")){this.pause()}this.fire(EVT_PREVCLICK);this.prev()},prev:function(){this.fire("backward")},forward:function(){var k=this;if((k.current==k._high)||(!k._disableTransition&&k._moving)){return}var h=k._cb.one(".current"),f=h.get("nextSibling");if(!f){f=k._cb.all("li."+k.cssclass).item(0)}this._restoreCurrent();f.addClass("current");h.removeClass("current");k._moving=true;var g=k._data(k.current,2);k.first=false;if(!g){k.last=true}else{k.last=false}var j=k._data(k.current,1);if(k._touchSupport){k._cb.transition({easing:k._easing,duration:k._disableTransition?0:(k._duration/1000),transform:k._transform(-1*k.twidth+"px")},function(){k.fire("repaint",{backward:false,forward:true,resize:false,sync:false})})}else{k._transOrLeft(k._cb,-1*k.twidth);k.fire("repaint",{backward:false,forward:true,resize:false,sync:false})}},backward:function(){var j=this;if((j.current==j._low)||(!j._disableTransition&&j._moving)){return}var h=e.one(".current"),f=h.get("previousSibling");if(!f){f=j._cb.all("li."+j.cssclass).item(2)}j._moving=true;j._restoreCurrent();f.addClass("current");h.removeClass("current");var g=j._data(j.current,-2);j.last=false;if(!g){j.first=true}else{j.first=false}var k=j._data(j.current,-1);if(j._touchSupport){j._cb.transition({easing:j._easing,duration:j._disableTransition?0:(j._duration/1000),transform:j._transform(j.twidth+"px")},function(){j.fire("repaint",{backward:true,forward:false,resize:false,sync:false})})}else{j._transOrLeft(j._cb,j.twidth);j.fire("repaint",{backward:true,forward:false,resize:false,sync:false})}},_toggleNextPrev:function(){var g=this.current;if(!this._data(g,-1)){this._prvNode.hide()}else{this._prvNode.show()}var f=e.Lang.isNumber(this.io.off)?this.io.off:1;if(g>=(this.io.get("total")-f)){this._nxtNode.hide();this.fire(EVT_END)}else{this._nxtNode.show()}},_getTime:function(){var f=new Date();return f.getTime()},repaint:function(n){var o=this;var g=o._cb.one(".current");var k=g.get("nextSibling");if(!k){k=o._cb.all("li."+o.cssclass).item(0)}var f=g.get("previousSibling");if(!f){f=o._cb.all("li."+o.cssclass).item(2)}if(!n.resize){o._transOrLeft(o._cb,0)}o.previous=o.current;o.current=parseInt(g.getAttribute("data-id"));o._transOrLeft(g,0);var p=o._data(o.current);if(p){if(n.forward||n.backward){o._updateBrowser(o.current,p)}n.resize&&o._syncItem(p,g)}var m=o._data(this.current,1),j=o._data(this.current,-1),h=o.io.offset(o.current,-1),l=o.io.offset(o.current,1);if(f){if((n.backward||n.sync)&&j){o._setItem(j,f,h);o._setItemID(h,f);o.prefetched[h]=1}else{if(n.resize&&j){o._syncItem(j,f)}}o._transOrLeft(f,-1*o.twidth)}if(k){if((n.forward||n.sync)&&m){o._setItem(m,k,l);o._setItemID(l,k);o.prefetched[l]=1}else{if(n.resize&&m){o._syncItem(m,k)}}o._transOrLeft(k,o.twidth)}o._moving=false;if(n.forward||n.backward){o.fire(EVT_ITEMCHANGE,{data:p,logPV:true,index:o.current,fromSrp:false,prevIndex:o.previous,node:g,forward:n.forward})}o._toggleNextPrev()},_onTouchStart:function(f){f=f.touches[0];c=f.pageX;b=f.pageY},_onTouchMove:function(g){if(this._moving){return}g=g.touches[0];if(c<g.pageX){var f=false}else{var f=true}if((f&&this.current==this._high)||(!f&&this.current==this._low)){return}var h=g.pageX-c;this._cb.setStyle("transform",this._transform(h+"px"))},_onFlick:function(g){now=this._getTime();diff=now-time;time=this._getTime();if(diff<this.get("transitionLimit")){this._disableTransition=true}else{this._disableTransition=false}if(this._moving){return}if(g.flick.distance==0&&g.flick.velocity==0){return}if(g.flick.axis=="y"){this._cb.setStyle("transform",this._transform(0));return true}var f=g.flick.distance<0;var h=g.flick.distance>0;if(f&&!this.last){this.fire("forward")}if(h&&!this.first){this.fire("backward")}},_onResize:function(f,g){this.fire(EVT_RESIZE,{src:g});this._scrollToTop();this._setDims();this._resizeContents(g);this.fire("repaint",{backward:false,forward:false,resize:true,sync:false})},_moveTo:function(h,g){var f=this;if(!e.Lang.isValue(g)){g=true}if(f.get("isPlaying")){f.pause()}if(h==f.current){return}f._restoreCurrent();f.previous=f.current;f.current=h;f._updateUI(false,g)},_updateBrowser:function(g,f){if(this.get("disableHistory")){return}var j=f[this.get("titleField")],h=f[this.get("urlField")]||f.fpurl;if(!this.get("fullScreenMode")){this.history&&this.history.addValue("index",g,{title:j,url:h})}e.config.doc.title=this._htmlDecode(j)},_detachEvents:function(f){e.Array.each(this._events||[],function(g){g.detach()},this);this._events=[]},_scrollToTop:function(){if(e.UA.iphone){e.config.win.scrollTo(0,1)}else{if(e.UA.android||e.UA.mobile||(e.UA.ie&&e.UA.ie<=7)){e.config.win.scrollTo(0,0)}}},_setDims:function(){var f=this._bb.get("region");this.width=f.width;this.twidth=f.width;this.height=f.height},play:function(){this._cancelPlayTimer();this.set("isPlaying",true);playTimer.timer=e.later(playTimer.startDelay,this,"_startPlay");this.fire(EVT_PLAY)},_startPlay:function(){this._cancelPlayTimer();this.next();playTimer.timer=e.later(playTimer.delay,this,"next",null,true)},pause:function(){this._cancelPlayTimer();this.set("isPlaying",false);this.fire("repaint",{backward:false,forward:false,resize:true,sync:false});this.fire(EVT_PAUSE)},_cancelPlayTimer:function(){if(playTimer.timer){playTimer.timer.cancel()}},_setItemID:function(g,f){f.setAttribute("data-id",g)},_setItem:function(f,g,h){if(this.compiled){g.setHTML(this.compiled(f))}this._syncItem(f,g)},_htmlDecode:function(f){if(!this.dummyDiv){this.dummyDiv=e.Node.create("<div></div>")}return this.dummyDiv.setContent(f).get("text")},_resizeContents:function(){},_bindCustom:function(){},_restoreCurrent:function(){},_syncItem:function(f,g){}});e.namespace("MMSearch").Surfer=a},"1.0.0",{requires:["widget-base","node","transition","event","json-parse","template-micro"]});YUI.add("surfer-base-plugin",function(b){b.namespace("MMSearch");function a(c){a.superclass.constructor.apply(this,arguments)}a.NAME="SurferBasePlugin";a.NS="sbp";a.ATTRS={};b.extend(a,b.Plugin.Base,{initializer:function(){this.events=[]},destroy:function(){b.each(this.events,function(d,c){if(d){d.detach()}});this.events=[]},_pushEvent:function(c){this.events.push(c)}});b.namespace("MMSearch").SurferBasePlugin=a},"0.0.1",{requires:["event","plugin"]});YUI.add("right-rail",function(b){function a(){a.superclass.constructor.apply(this,arguments)}a.ATTRS={boundingBox:{setter:b.one},contentBox:{setter:b.one},width:{value:290,validator:b.Lang.isNumber},toggleButton:{setter:b.one},mask:{setter:b.one},searchbox:{setter:b.one}};a.NAME="right-rail";a.NS="rrail";b.extend(a,b.MMSearch.SurferBasePlugin,{initializer:function(){this.bb=this.get("boundingBox");this.cb=this.get("contentBox");this.searchbox=this.get("searcbox");this.rrwidth=this.get("width");this._bindUI()},_bindUI:function(){this.onHostEvent("resize",this._onHostResize);this.onHostEvent("itemChange",this._closeRightRail);this._pushEvent(this.get("toggleButton").on("click",this._toggleRightRail,this));this._pushEvent(this.get("mask").on("click",this._closeRightRail,this));this._onHostResize()},_toggleRightRail:function(){if(this.bb.hasClass("open")){this._closeRightRail()}else{this._openRightRail()}},_openRightRail:function(){var c=this;c.bb.setStyle("overflow","hidden");c.bb.one(".card-btns").hide();c.cb.transition({duration:0.2,easing:"ease-in",right:"0px",opacity:1},function(){c.bb.addClass("open")});this.fire("open")},_closeRightRail:function(){var c=this;if(!this.bb.hasClass("open")){return}if(this.searchbox){this.searchbox.blur()}this.bb.removeClass("open");this.cb.transition({duration:0.2,easing:"ease-out",right:"-"+this.rrwidth+"px",opacity:0},function(){c.bb.setStyle("overflow","visible");c.bb.one(".card-btns").show()});this.fire("close")},_onHostResize:function(c){}});b.namespace("MMSearch").RightRailPlugin=a},"1.0.0",{requires:["node","surfer-base-plugin"]});YUI.add("right-rail-reco",function(b){b.namespace("MMSearch");function a(){a.superclass.constructor.apply(this,arguments)}a.NAME="RightRailRecoPlugin";a.NS="rreco";a.ATTRS={url:{value:""},strings:{value:{trendingtopics:"Trending Topics",recommendedtopics:"Recommended Topics",exploretags:"Related Topics"}},searchbox:{setter:b.one},sbclear:{value:"#sbxclr",setter:b.one},boundingNode:{setter:b.one},contentNode:{setter:b.one},hideClass:{value:"sa-hidden"}};b.extend(a,b.MMSearch.SurferBasePlugin,{initializer:function(){this.cb=this.get("contentNode");this.bb=this.get("boundingNode");this.sbclear=this.get("sbclear");this._bindUI();this._fetch()},_bindUI:function(){var c=this.get("searchbox");this._pushEvent(c.on("valueChange",function(d){if(c.get("value")==""){this.sbclear.hide();this.show()}else{this.sbclear.show()}},this));this._pushEvent(c.on("focus",function(d){if(c.get("value")==""){this.show()}},this));this._pushEvent(c.on("clickoutside",function(d){if(d.target!=this.sbclear){this.hide()}},this));this._pushEvent(this.sbclear.on("click",function(d){c.set("value","");this.sbclear.hide();this.show()},this))},_fetch:function(){var c=this.get("url");if(!c){return}b.jsonp(c+"&callback={callback}",{on:{success:function(d){this._build(d)}},context:this})},_build:function(e){var d="";var c=this;b.each(e,function(g,f){d+="<h2>"+c.get("strings")[f]+"</h2><ul>";b.each(g,function(h){d+='<li><a href="'+h.link+'">'+h.key+"</a></li>"});d+="</ul>"});this.cb.set("innerHTML",d)},show:function(){this.bb.removeClass(this.get("hideClass"))},hide:function(){this.bb.addClass(this.get("hideClass"))}});b.namespace("MMSearch").RightRailRecoPlugin=a},"0.0.1",{requires:["node","jsonp","jsonp-url","event-valuechange","event-outside","surfer-base-plugin"]});YUI.add("surfer-util",function(a){a.MMSearch.SurferUtil={beacon:function(c){if(!c){return}var b=new Image();b.src=c+(c.indexOf("?")===-1?"?":"&")+(new Date()).getTime()},buildSearchUrl:function(d,g,e,j){var f=d.get("form"),c=e||f.getAttribute("action"),b=f.all("input,select,textarea"),h=[];if(!j){j={}}b.each(function(n){var m,l;if(n.get("tagName").toLowerCase()==="input"){switch(n.get("type")){case"button":case"image":case"reset":case"submit":return;case"checkbox":case"radio":if(!n.get("checked")){return}break}}m=n.get("name");if(m===d.get("name")){l=g}else{if(!j[m]){l=n.get("value")}}if(l){h.push(encodeURIComponent(m)+"="+encodeURIComponent(l))}});a.each(j,function(m,l){h.push(encodeURIComponent(l)+"="+encodeURIComponent(m))});return c+(c.indexOf("?")===-1?"?":"&")+h.join("&")},highlightAll:function(e,d){var c="(&[^;\\s]*)?(%needles)";var b=function(f,h,g){return h&&!(/\s/).test(g)?f:"<b>{s}</b>".replace(/\{s\}/g,g)};d=a.Lang.isArray(d)?d.concat():[d];for(i=0,len=d.length;i<len;++i){d[i]=a.Escape.regex(a.Escape.html(d[i]))}e=a.Escape.html(e);return e.replace(new RegExp(c.replace("%needles",d.join("|")),"gi"),b)},truncate:function(h,c,d){var e,g,f,b=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];h=a.Lang.trim(h);if(c<=0||h.length<=c){return h}f=new RegExp("(\\"+b.join("|\\")+")","g");d=d?d.replace(f,"\\$1").split(/\s+/):[];for(e=0;e<d.length;++e){g=d[e].replace;if(g.length>3){h=h.replace(new RegExp("(?:^|\\s+)"+g+"(?:\\s+)?","gi"),"...");if(h.length<=c){return h}}}return a.Lang.trim(h.substr(0,c-3)).replace(/\.+$/,"")+"..."},isVisible:function(b){if(!b||b.getComputedStyle("display")=="none"||b.getComputedStyle("visibility")=="hidden"){return false}return true}}},"1.0.0",{requires:["node"]});YUI.add("idle-timer",function(g){var d=false,h=-1,b=false,f=g.config.doc,e=30000;function c(j){clearTimeout(h);if(b){if(/visibilitychange/.test(j.type)){a(f.hidden||f.msHidden||f.webkitHidden||f.mozHidden)}else{if(d){a()}}h=setTimeout(a,e)}}function a(j){var k=false;if(typeof j!="undefined"){if(j!=d){d=j;k=true}}else{d=!d;k=true}if(k){g.IdleTimer.fire(d?"idle":"active")}}g.IdleTimer={isRunning:function(){return b},isIdle:function(){return d},start:function(j){b=true;d=false;if(typeof j=="number"){e=j}g.on("mousemove",c,f);g.on("keydown",c,f);g.on("mousedown",c,f);g.on("scroll",c);if(f.addEventListener){f.addEventListener("msvisibilitychange",c,false);f.addEventListener("webkitvisibilitychange",c,false);f.addEventListener("mozvisibilitychange",c,false)}h=setTimeout(a,e)},stop:function(){b=false;clearTimeout(h);g.detach("mousemove",c,f);g.detach("keydown",c,f);g.detach("mousedown",c,f);g.detach("scroll",c);if(f.removeEventListener){f.removeEventListener("msvisibilitychange",c,false);f.removeEventListener("webkitvisibilitychange",c,false);f.removeEventListener("mozvisibilitychange",c,false)}}};g.augment(g.IdleTimer,g.Event.Target)},"0.1",{requires:["event","event-custom"]});YUI.add("idle-timer-plugin",function(a){var g="nodes",d="durationActive",f="durationIdle",c="it_active",b="it_idle",h="timer",j;function e(k){e.superclass.constructor.apply(this,arguments)}e.NAME="IdlePlugin";e.NS="idle";e.ATTRS={timer:{value:2500},durationActive:{value:0.15},durationIdle:{value:0.75},nodes:{}};a.extend(e,a.Plugin.Base,{initializer:function(){j=this.get("host");a.IdleTimer.subscribe("active",this._onActive,this);a.IdleTimer.subscribe("idle",this._onIdle,this);a.IdleTimer.start(this.get(h))},destructor:function(){this._onActive();a.IdleTimer.stop()},reset:function(){a.IdleTimer.stop();a.IdleTimer.start(this.get(h))},_onActive:function(){var k=this.get(g);for(var l=0;l<k.length;l++){var m=k[l];m.node.transition(a.merge(m.active,{duration:this.get(d)}))}j.fire(c)},_onIdle:function(){var k=this.get(g);for(var l=0;l<k.length;l++){var m=k[l];m.node.transition(a.merge(m.idle,{duration:this.get(f)}))}j.fire(b)}});a.namespace("MMSearch").IdlePlugin=e},"0.0.1",{requires:["idle-timer","transition"]});YUI.add("fullscreen",function(c){var b=c.config.doc,a=c.Lang;c.FullScreen={EVT_FULLSCREENCHANGE:"",isActive:function(){return false},request:function(d){},cancel:function(){}};(function(){var d=["webkit","moz"],f="",e=false;if(!a.isUndefined(b.cancelFullScreen)||!a.isUndefined(b.exitFullScreen)){e=true}else{c.Array.each(d,function(g){if(!a.isUndefined(b[g+"CancelFullScreen"])){f=g;e=true}})}if(e){switch(f){case"moz":c.mix(c.FullScreen,{EVT_FULLSCREENCHANGE:"mozfullscreenchange",_attachEvents:function(){b.addEventListener(EVT_FULLSCREENCHANGE,c.bind(this._onChange,this),true)},request:function(g){g.mozRequestFullScreen()},cancel:function(){b.mozCancelFullScreen()},isActive:function(){return b.mozFullScreen}},true);break;case"webkit":c.mix(c.FullScreen,{EVT_FULLSCREENCHANGE:"webkitfullscreenchange",request:function(g){g.webkitRequestFullScreen()},cancel:function(){b.webkitCancelFullScreen()},isActive:function(){return b.webkitIsFullScreen}},true);break;default:c.mix(c.FullScreen,{EVT_FULLSCREENCHANGE:"fullscreenchange",request:function(g){g.requestFullScreen()},cancel:function(){b.exitFullscreen()},isActive:function(){return a.isUndefined(b.fullscreenEnabled)?b.fullScreen:b.fullscreenEnabled}},true);break}}}())},"1.0.0",{requires:["base"]});YUI.add("fullscreen-plugin",function(e){var c="fullscreen",d=e.config.doc,b=e.Lang;function a(f){a.superclass.constructor.apply(this,arguments)}a.NAME="fullScreenPlugin";a.NS="fullscreen";a.ATTRS={node:{value:e.one("body"),validator:e.one},activateNode:{validator:e.one},cancelNode:{validator:e.one},fullScreenActive:{value:false,validator:b.isBoolean}};e.extend(a,e.Plugin.Base,{initializer:function(f){if(e.FullScreen.EVT_FULLSCREENCHANGE){d.addEventListener(e.FullScreen.EVT_FULLSCREENCHANGE,e.bind(this._onStateChange,this),true)}else{this.get("node").on("key",this._onStateChange,"esc",this)}if(this.get("cancelNode")){this.get("activateNode").on("click",this.toggle,this,false);this.get("cancelNode").on("click",this.toggle,this,true)}else{this.get("activateNode").on("click",this.toggle,this)}},_onStateChange:function(){var f=e.FullScreen.isActive();if(f!=this.get("fullScreenActive")){this.set("fullScreenActive",f);this.sync()}},toggle:function(k,j){var h=this.get("node"),g=h.getDOMNode(),f=this.get("fullScreenActive");if(typeof j=="boolean"){f=j}if(!f){e.FullScreen.request(g)}else{e.FullScreen.cancel()}this.set("fullScreenActive",!f);this.sync()},sync:function(){var g=this.get("node"),f=this.get("fullScreenActive");if(f){g.addClass(c)}else{g.removeClass(c)}this.fire("fullScreenChange",{active:f})}});e.namespace("MMSearch").FullScreenPlugin=a},"0.0.1",{requires:["fullscreen","plugin","event-custom"]});YUI.add("surfer-datamodel",function(b){function a(c){a.superclass.constructor.apply(this,arguments)}a.ATTRS={source:{value:null},schema:{},hits:{value:30,validator:b.Lang.isNumber},total:{value:9,setter:function(c){return Math.min(c,this.get("maxItems"))}},maxItems:{value:999,validator:b.Lang.isNumber},buffer:{value:10,validator:b.Lang.isNumber},shouldDedup:{value:true,validator:b.Lang.isBoolean},ddSlottedCount:{value:0,validator:b.Lang.isNumber}};a.NAME="dataModel";b.extend(a,b.LazyModelList,{initializer:function(c){this._offsets={};this._skip=this.get("ddSlottedCount");this.datasource=new b.DataSource.Get({source:this.get("source")});this.datasource.plug({fn:b.Plugin.DataSourceJSONSchema,cfg:this.get("schema")})},item:function(c,d){var f=c;if(!this._offsets[0]){this._send(0);this._offsets[0]=true}if(d){f=this.offset(c,d)}else{var e=(f>this._skip)?f-this._skip:f;if(e){this._preFetch(e)}}return this._items[f]},_preFetch:function(g){var c=this.get("hits"),e=this.get("buffer");var h=Math.ceil(g/c)-1,k=h*c,d=(h+1)*c,j=null,f=true;if((d-g)<e){j=(h+1)*c}else{if((g-k)<e&&h>0){f=false;j=(h-1)*c}}if(j!=null){j+=1;if(!this._offsets[j]){this._send(j);this._offsets[j]=true}}},_send:function(c){this.datasource.sendRequest({request:"&b="+c,callback:{success:b.bind(this._onSuccess,this),failure:function(d){}}})},_onSuccess:function(o){var g=o.response,s=g.meta,m=g.results,r=this._items.length,n=r,f,h=this.get("hits");if(s&&s.first<10&&this.get("shouldDedup")){var l={},j=[],d=b.Lang.isValue(this._items[0].oid)?"oid":"vid",c=0,q=null;if(s.slotted){this._skip+=s.slotted}b.each(this._items,function(e,t){l[e[d].toUpperCase()]=t});b.each(m,function(e){q=l[e[d].toUpperCase()];if(!b.Lang.isValue(q)&&b.Lang.isValue(e.muid)){q=l[e.muid.toUpperCase()]}if(c>=r||!b.Lang.isValue(q)){e.pos=n++;j.push(e)}else{if(b.Lang.isValue(q)){var t=this._items[q].pos;this._items[q]=b.merge(this._items[q],e);this._items[q].pos=t;if(this._items[q].fpurl){this._items[q].fpurl=this._items[q].fpurl.replace("&tt=b","&tt=s")}++c}}},this);m=j;var k=this._items.concat(m)}else{b.each(m,function(e){e.pos=n++});var k=m}this.add(m);var p=s.total;if(s.count<h){p=s.last}this.set("total",p);f={m:s,results:k,total:p,forward:true};if(o.data.ads){f.ads=o.data.ads}this.fire("data",f)},offset:function(c,d){if(!d){d=0}return(c+d)},hasMore:function(){var c=this._items.length,c=(c>this._skip)?c-this._skip:c;if(c<this.get("total")){return true}return false}});b.namespace("MMSearch").DataModel=a},"1.0.0",{requires:["base","lazy-model-list","datasource-get","datasource-jsonschema","dataschema-json"]});